name: Curl Component
description: Component to perform curl and return JSON
inputs:
  - {name: url, type: String, description: 'The URL for curl input'}
outputs:
  - {name: output_json, type: Json, description: 'The JSON output'}
implementation:
  container:
    image: python:3.9
    command:
      - python3
      - -c
      - |
        import subprocess
        import json
        import sys
        
        url = sys.argv[1]
        result = subprocess.run(['curl', url], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
        if result.returncode == 0:
            try:
                json_data = json.loads(result.stdout)
                with open('/output/output_json', 'w') as f:
                    json.dump(json_data, f)
            except json.JSONDecodeError:
                print("Invalid JSON")
        else:
            print("Curl command failed", file=sys.stderr)
    args:
      - {inputValue: url}
      - {outputPath: output_json}
